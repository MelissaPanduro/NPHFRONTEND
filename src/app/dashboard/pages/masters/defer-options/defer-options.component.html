<header class="bg-white shadow" style="padding: 2rem 0;">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 text-left">
    <h1 class="text-7xl font-extrabold text-blue-900 dark:text-blue-400">
      <span class="text-transparent bg-clip-text bg-gradient-to-r from-sky-400 to-blue-600">
        Productos
      </span>
    </h1>
  </div>
</header>

<div class="container mx-auto my-8 p-4 bg-white shadow-md rounded-lg">
  <h2 class="text-2xl font-bold mb-4">Listado de Productos</h2>

  <!-- Botón para agregar producto -->
  <div class="mb-4">
    <button class="bg-blue-600 text-white px-4 py-2 rounded" (click)="openModal()">Agregar Producto</button>
  </div>

  <!-- Switcher de estado -->
  <div class="mb-4 flex items-center">
    <label for="statusSwitcher" class="mr-3 text-lg font-semibold">Estado:</label>
    <div class="relative inline-block w-12 mr-2 align-middle select-none">
      <input
        type="checkbox"
        id="statusSwitcher"
        [(ngModel)]="isActive"
        (change)="toggleStatus()"
        class="toggle-input absolute block w-6 h-6 rounded-full bg-white border-2 appearance-none cursor-pointer"
      />
      <span class="toggle-label block overflow-hidden h-6 rounded-full" [ngClass]="isActive ? 'bg-green-500' : 'bg-red-500'"></span>
    </div>
    <span class="ml-2 font-weight-bold" [ngClass]="isActive ? 'text-green-500' : 'text-red-500'">
      {{ isActive ? 'Activo' : 'Inactivo' }}
    </span>
  </div>

  <!-- Tabla de productos -->
  <table class="min-w-full text-center border-separate" style="border-spacing: 0 10px;">
    <thead>
      <tr>
        <th class="px-6 py-3 text-lg font-semibold text-blue-900 bg-blue-100">Nombre</th>
        <th class="px-6 py-3 text-lg font-semibold text-blue-900 bg-blue-100">Descripción</th>
        <th class="px-6 py-3 text-lg font-semibold text-blue-900 bg-blue-100">Unidad de Medida</th>
        <th class="px-6 py-3 text-lg font-semibold text-blue-900 bg-blue-100">Precio Unitario</th>
        <th class="px-6 py-3 text-lg font-semibold text-blue-900 bg-blue-100">Categoria</th>
        <th class="px-6 py-3 text-lg font-semibold text-blue-900 bg-blue-100">Estado</th>
        <th class="px-6 py-3 text-lg font-semibold text-blue-900 bg-blue-100">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let product of filteredProducts">
        <td class="px-6 py-4 bg-gray-100">{{ product.nombre }}</td>
        <td class="px-6 py-4 bg-gray-100">{{ product.descripcion }}</td>
        <td class="px-6 py-4 bg-gray-100">{{ product.unidadMedida }}</td>
        <td class="px-6 py-4 bg-gray-100">{{ product.precioUnitario }}</td>
        <td class="px-6 py-4 bg-gray-100">{{ product.categoria }}</td>
        <td class="px-6 py-4 bg-gray-100">{{ product.estado }}</td>
        <td class="px-6 py-4 bg-gray-100">
          <button *ngIf="product.estado === 'activo'" class="bg-yellow-500 text-white px-3 py-1 rounded mr-2" (click)="editProductDetails(product)">Editar</button>
          <button *ngIf="product.estado === 'activo'" class="bg-red-500 text-white px-3 py-1 rounded" (click)="inactivateProduct(product.idProducto)">Eliminar</button>
          <button *ngIf="product.estado === 'Inactivo'" class="bg-green-500 text-white px-3 py-1 rounded mr-2" (click)="activateProduct(product.idProducto)">Restaurar</button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Estado de carga -->
  <div *ngIf="isLoading" class="text-center mt-4">
    <p>Cargando productos...</p>
  </div>
</div>

<!-- Modal para agregar/editar producto -->
<div *ngIf="isModalOpen" class="fixed inset-0 flex items-center justify-center bg-gray-500 bg-opacity-50 z-50">
  <div class="bg-white p-6 rounded-lg w-96">
    <h2 class="text-2xl font-bold mb-4">{{ isEditMode ? 'Editar Producto' : 'Agregar Producto' }}</h2>
    <form (ngSubmit)="isEditMode ? updateProduct() : addProduct()">
      <div class="mb-4">
        <label class="block text-lg font-semibold" for="name">Nombre</label>
        <input class="border p-2 w-full rounded" id="name" [(ngModel)]="productForm.nombre" name="name" required />
      </div>
      <div class="mb-4">
        <label class="block text-lg font-semibold" for="description">Descripción</label>
        <input class="border p-2 w-full rounded" id="description" [(ngModel)]="productForm.descripcion" name="description" required />
      </div>
      <div class="mb-4">
        <label class="block text-lg font-semibold" for="unidadMedida">Unidad de Medida</label>
        <input class="border p-2 w-full rounded" id="unidadMedida" [(ngModel)]="productForm.unidadMedida" name="description" required />
      </div>
      <div class="mb-4">
        <label class="block text-lg font-semibold" for="price">Precio Unitario</label>
        <input class="border p-2 w-full rounded" id="price" [(ngModel)]="productForm.precioUnitario" name="price" type="number" min="0" required />
      </div>
      <div class="mb-4">
        <label class="block text-lg font-semibold" for="categoria">Categoria</label>
        <input class="border p-2 w-full rounded" id="categoria" [(ngModel)]="productForm.categoria" name="price" type="text" required />
      </div>
      <div class="flex justify-end">
        <button type="button" class="bg-gray-500 text-white px-4 py-2 rounded mr-2" (click)="closeModal()">Cancelar</button>
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded">{{ isEditMode ? 'Actualizar' : 'Agregar' }}</button>
      </div>
    </form>
  </div>
</div>

<style>
  .toggle-input:checked {
    transform: translateX(100%);
    border-color: #28a745;
  }

  .toggle-input {
    transition: transform 0.3s ease-in-out, border-color 0.3s ease;
  }

  .toggle-label {
    transition: background-color 0.3s ease-in-out;
  }

  .toggle-label:before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 14px;
    height: 14px;
    background-color: white;
    border-radius: 50%;
    transition: transform 0.3s ease;
  }
</style>
